{% extends "base.html" %}
{% load i18n rules %}

{% block content %}
<div class="text-sm flex items-center mb-3">
  <a href="{% url 'projects:projects_overview' %}"
     class="text-blue-800 hover:text-blue-600 mr-2">Projects</a>
  <span class="text-gray-500 mr-2">&gt;</span>
  <a href="{{ project.get_absolute_url }}"
     class="text-blue-800 hover:text-blue-600 mr-2">
    {{ project.name }}
  </a>
</div>

{% has_perm "projects.change_project" user project as can_change_project %}
{% has_perm "projects.delete_project" user project as can_delete_project %}

<div class="sm:flex items-center justify-between mb-3">
  <h1 class="text-xl font-bold mb-3 sm:mb-0">{{ project.name }}</h1>
  <div class="sm:flex items-center">
    <a href="{% url 'cards:create_card' project.id %}"
       class="px-4 py-1 rounded border bg-white hover:bg-gray-100 sm:mr-2 mb-1 sm:mb-0 block w-full sm:w-auto">
      <i class="fa fa-plus mr-2"></i>{% translate "Add Card" %}
    </a>
    <a href=""
       class="px-4 py-1 rounded border bg-white hover:bg-gray-100 sm:mr-2 mb-1 sm:m-0 block w-full sm:w-auto">
      <i class="fa fa-plus mr-2"></i>{% translate "Add Column" %}
    </a>
    {% if can_change_project %}
    <a href="{% url 'projects:edit_project' project.id %}"
       class="px-4 py-1 rounded border bg-white hover:bg-gray-100 block w-full sm:w-auto mr-2">
      <i class="fa fa-pen mr-2"></i>{% translate "Edit Project" %}
    </a>
    {% endif %}
    {% if can_delete_project %}
    <button class="px-4 py-1 rounded border bg-white hover:bg-red-100 block w-full sm:w-auto border-red-800 text-red-800">
      <i class="fa fa-trash mr-2"></i>{% translate "Delete Project" %}
    </button>
    {% endif %}

  </div>
</div>

<div class="md:flex md:overflow-y-auto md:whitespace-no-wrap">
  {% for column in columns %}
  <div class="mb-1 md:mb-0 md:mr-1 md:w-1/4 border">
    <div class="bg-gray-100 flex items-center justify-start md:justify-center font-bold text-lg p-2">
      {{ column.name }}
      <a class="ml-2 focus:outline-none"
         title="Add New Card"
         href="{% url 'cards:create_card_for_column' project.id column.id %}">
        <i class="fa fa-plus"></i>
      </a>
    </div>
    <div class="p-2 bg-white"
         data-controller="drag"
         data-drag-group="shared"
         data-drag-limit="{{ project.task_limit }}"
         data-drag-url="{% url 'cards:move_cards' column.id %}">
      {% for card in cards %}
      {% if card.column == column %}
      <div class="p-2 mb-3 border rounded bg-blue-500 text-white"
           data-id="{{ card.id }}"
           data-target="drag.draggable">
        <div class="mb-1">
          <a href="{{ card.get_absolute_url }}"
             class="underline font-bold">{{ card.name }}</a>
        </div>
        <div>
          <span class="font-semibold"
                title="{% translate 'Priority' %}">P {{ card.priority }}</span> /
          <span class="font-semibold"
                title="{% translate 'Complexity' %}">C {{ card.complexity }}</span> /
          <span class="font-semibold"
                title="{% translate 'Estimated Hours' %}">H {{ card.hours_estimated }}</span>
        </div>
      </div>
      {% endif %}
      {% endfor %}
    </div>
  </div>
  {% endfor %}
</div>

{% endblock content %}
